

#include <stdint.h>
#include "Map.h"
#include "Tiles.h"
#include "tm4c123gh6pm.h"
#include "ST7735.h"
#include "Grid.h"

/* 
BLBush 		0
BMBush 		1
BRBush 		2
Door			3
Floor			4
TLBush		5
TMBush		6
TRBush		7
dungTile	8
Bush			9
FaBush 		10
BFaBush		11
BBBush		12
BBLBush		13
BBRBush		14
BTBush		15
BTLBush		16
BTRBush		17	
BBush			18
TOpen			19
BROpen		20
TROpen		21
TLOpen		22
BLOpen		23
GFLoor		24
BBushG		25
TLBushG		26
TBushG		27
TRBushG		28
TMOpen		29
*/
uint8_t OverWorld0 [10][8] = {
{1, 1, 1, 4, 6, 1, 1, 1},
{1, 1, 1, 4, 4, 4, 6, 1},
{1, 1, 1, 4, 4, 4, 6, 1},
{1, 1, 0, 4, 4, 4, 6, 1},
{4, 4, 4, 4, 4, 4, 6, 1},
{4, 4, 4, 4, 4, 4, 6, 1},
{2, 4, 4, 4, 4, 4, 6, 1},
{3, 4, 4, 4, 4, 4, 6, 1},
{1, 2, 4, 4, 4, 4, 6, 1},
{1, 1, 2, 4, 7, 1, 1, 1},
};
uint8_t OverWorld1 [10][8] = {
{1, 1, 0, 4, 4, 5, 1, 1},
{1, 0, 4, 4, 4, 4, 6, 1},
{1, 4, 4,10,10, 4, 6, 1},
{1, 4, 4, 4, 4, 4, 6, 1},
{1, 4, 4, 4, 4, 4, 4, 4},
{1, 4,10, 4,10, 4, 4, 4},
{1, 4, 4, 4, 4, 4, 6, 1},
{1, 4,10, 4,10, 4, 6, 1},
{1, 2, 4, 4, 4, 4, 6, 1},
{1, 1, 2, 4, 4, 7, 1, 1},
};
uint8_t OverWorld2 [10][8] = {
{9, 9, 4, 4, 4, 4, 9, 9},
{4, 4, 4, 4, 9, 4, 9, 9},
{9, 9, 4, 9, 4, 4, 9, 9},
{4, 4, 4, 4, 9, 4, 9, 9},
{9, 9, 4, 9, 4, 4, 9, 9},
{4, 4, 4, 4, 9, 4, 9, 9},
{9, 9, 4, 9, 4, 4, 9, 9},
{4, 4, 4, 4, 4, 4, 9, 9},
{1, 2, 4, 4, 4, 7, 1, 1},
{1, 1, 2, 4, 7, 1, 1, 1},
};
uint8_t OverWorld3 [10][8] = {
{1, 1, 0, 4, 5, 1, 1, 1},
{1, 0, 4, 4, 4, 5, 1, 1},
{4, 4, 4,10, 4, 4, 6, 1},
{4, 4, 4, 4, 4, 4, 6, 1},
{2, 4, 4, 4, 4, 4, 6, 1},
{1, 4,10, 4,10, 4, 6, 1},
{1, 4, 4, 4, 4, 4, 6, 1},
{1, 4,10, 4,10, 4, 6, 1},
{1, 4, 4, 4, 4, 4, 6, 1},
{1, 4, 4, 4, 4, 4, 6, 1},
};

uint8_t OverWorld4[10][8] = {
{9,9,9,4,4,9,9,9},
{9,4,4,4,4,4,4,4},
{9,9,4,9,9,4,9,9},
{9,4,4,4,9,4,4,4},
{4,4,4,9,9,4,9,9},
{4,4,4,9,9,4,4,4},
{9,9,4,9,4,4,9,9},
{9,9,4,9,9,4,4,4},
{1,2,4,4,4,4,7,1},
{1,1,2,4,4,7,1,1}
};

uint8_t OverWorld5[10][8] = {
{12,12,12,12,12,12,12,12},
{12,12,13, 4, 4,16,12,12},
{12,12, 4, 4, 4, 4,15,12},
{12,12, 4, 9, 9, 4,15,12},
{12,12, 4, 4, 4, 4, 4, 4},
{12,12, 4, 4, 4, 4, 4, 4},
{12,12, 4, 9, 9, 4,15,12},
{12,12, 4, 4, 4, 4,15,12},
{12,12,14, 4, 4,17,12,12},
{12,12,12,12,12,12,12,12}
};

uint8_t OverWorld6[10][8] = {
{1, 1, 0, 4, 4, 5, 1, 1},
{1, 0, 4, 4, 4, 4, 5, 1},
{1, 4, 4, 4, 4, 4, 4, 4},
{1, 4,11,11,11, 4, 4, 4},
{4, 4, 4, 4, 4, 4, 7, 1},
{4, 4, 4, 4, 4, 4, 6, 1},
{1, 4,11, 4,11, 4, 6, 1},
{1, 4,11, 4,11, 4, 6, 1},
{1, 4,11, 4,11, 4, 6, 1},
{1, 4, 4, 4, 4, 4, 6, 1}
};

uint8_t OverWorld7[10][8] = {
{12,12,12,12,12,12,12,12},
{12,12,13, 4, 4,16,12,12},
{12,13, 4, 4, 4, 4,15,12},
{ 4, 4, 4, 4, 4, 4,15,12},
{ 4, 4, 4, 4, 4, 4,15,12},
{12,12,12,14, 4 ,4,15,12},
{12,12,12,12, 4, 4,15,12},
{12,12,12,13, 4, 4,15,12},
{12,12,13, 4, 4, 4,15,12},
{12,13, 4, 4, 4, 4,16,12}
};

uint8_t OverWorld8[10][8] = {
{1, 4, 4, 4, 4, 4, 6, 1},
{1, 4, 4, 4, 4, 4, 6, 1},
{1, 2, 4,10,10, 4, 6, 1},
{1, 0, 4, 4,10, 4, 6, 1},
{4, 4, 4, 4, 4, 4, 4, 4},
{4, 4, 4,10, 4, 4, 4, 4},
{2, 4, 4, 4,10, 4, 6, 1},
{1, 4, 4,10, 4, 4, 6, 1},
{1, 2, 4, 4, 4, 7, 1, 1},
{1, 1, 1, 1, 1, 1, 1, 1}
};

uint8_t OverWorld9[10][8] = {
{12,12,12,12,12,12,12,12},
{18,18, 4, 4,16,12,12,12},
{18,18, 4, 4, 4,16,12,12},
{18,18, 4, 4, 4, 4, 4, 4},
{18,18,18, 4, 4, 4, 4, 4},
{18,18,18, 4, 4, 4,17,12},
{18,18, 4, 4, 4,17,12,12},
{18,18, 4, 4, 4,15,12,12},
{18,18, 4, 4, 4,15,12,12},
{12,12,14, 4, 4,12,12,12}
};

uint8_t OverWorld10[10][8] = {
{1, 4, 4, 4, 4, 4, 6, 1},
{1, 4, 4, 4, 4, 4, 6, 1},
{1, 4, 4,11,11, 4, 6, 1},
{1, 4, 4, 4,11, 4, 5, 1},
{1, 4, 4, 4, 4, 4, 4, 4},
{1, 4, 4, 4,11, 4, 4, 4},
{1, 4, 4,11,11, 4, 7, 1},
{1, 4, 4, 4, 4, 4, 6, 1},
{1, 2, 4, 4, 4, 7, 1, 1},
{1, 1, 1, 1, 1, 1, 1, 1}
};
uint8_t OverWorld11[10][8] = {
{ 1, 1, 1, 1, 1, 1, 1, 1},
{ 1, 1, 0, 4, 4, 5, 1, 1},
{ 1, 1, 4, 4, 4, 4, 6, 1},
{ 1, 1, 4,18,18, 4, 6, 1},
{ 4, 4, 4, 4, 4, 4, 6, 1},
{ 4, 4, 4, 4, 4, 4, 6, 1},
{ 1, 1, 4,18,18, 4, 6, 1},
{ 1, 1, 4, 4, 4, 4, 6, 1},
{ 1, 1, 2, 4, 4, 7, 1, 1},
{ 1, 1, 1, 1, 1, 1, 1, 1}
};
uint8_t OverWorld13[10][8] = {
{12,12,12,12,12,12,12,12},
{18,18, 4, 4,16,12,12,12},
{18,18, 4, 4, 4,16,12,12},
{18,18, 4, 4, 4, 4, 4, 4},
{ 4, 4, 4, 4, 4, 4, 4, 4},
{ 4, 4, 4, 4, 4, 4,17,12},
{18,18, 4, 4, 4,17,12,12},
{18,18, 4, 4, 4,15,12,12},
{18,18, 4, 4, 4,15,12,12},
{12,12,14, 4, 4,12,12,12}
};
uint8_t OverWorld14[10][8] = {
{25,25,25,25,25,25,25,25},
{25,24,24,24,24,26,25,25},
{25,24,24,24,24,24,27,25},
{25,24,21,20,24,24,27,25},
{25,24,19, 3,24,24,24,24},
{25,24,19, 3,24,24,24,24},
{25,24,22,23,24,24,27,25},
{25,24,24,24,24,24,27,25},
{25,24,24,24,24,28,25,25},
{25,25,25,25,25,25,25,25}
};
uint8_t Door1 [10][8] = {
{25,25,25,25,25,25,25,25},
{25,30,30,30,30,30,25,25},
{25,30,31,30,30,30,25,25},
{25,30,30,30,30,30,25,25},
{25,30,31,30,30,30,30,30},
{25,30,30,30,30,30,30,30},
{25,30,30,30,30,30,25,25},
{25,30,31,30,30,30,25,25},
{25,30,30,30,30,30,25,25},
{25,25,25,25,25,25,25,25},
};
uint8_t Dungeon1 [10][8] = {
{32,32,32,32,32,32,32,32},
{32, 8, 8, 8, 8, 8, 8,32},
{32, 8, 8, 8, 8, 8, 8,32},
{32, 8, 8, 8, 8, 8, 8,32},
{ 8, 8, 8, 8, 8, 8, 8,32},
{ 8, 8, 8, 8, 8, 8, 8,32},
{32, 8, 8, 8, 8, 8, 8,32},
{32, 8, 8, 8, 8, 8, 8,32},
{32, 8, 8, 8, 8, 8, 8,32},
{32,32,32,32,32,32,32,32},
};
uint8_t Dungeon2 [10][8] = {
{31,31,31,31,31,31,31,31},
{31,31,31,31,31,31,31,31},
{31,32,32,32,32,32,31,31},
{31,32, 8, 8, 8,32,32,32},
{31,32, 8, 8, 8, 8, 8, 8},
{31,32, 8, 8, 8, 8, 8, 8},
{31,32, 8, 8, 8,32,32,32},
{31,32,32,32,32,32,31,31},
{31,31,31,31,31,31,31,31},
{31,31,31,31,31,31,31,31},
};
uint8_t OverWorld12[10][8] = {
{12,12,12,12,12, 1, 1, 1},
{12,12,13, 4, 4,16, 1, 1},
{12,12, 4, 4, 4, 4,15, 1},
{12,12, 4,18, 9, 4,15, 1},
{12,12, 4, 4, 4, 4, 4, 4},
{12,12, 4, 4, 4, 4, 4, 4},
{12,12, 4,18, 9, 4,15, 1},
{12,12, 4, 4, 4, 4,15, 1},
{12,12,14, 4, 4,17, 1, 1},
{12,12,12,12,12, 1, 1, 1}
};

struct Maps_t {
	uint8_t (*ScreenMap[10])[8]; // WorldMap is a pointer to array_of_8_chars; assigned to the first element in an aray, which is an array_of_8_chars
};
struct Maps_t Maps[18] = {
{OverWorld0}, {OverWorld1}, {OverWorld2}, {OverWorld3}, {OverWorld4}, {OverWorld5}, {OverWorld6}, {OverWorld7}, {OverWorld8}, {OverWorld9}, {OverWorld10},
 {OverWorld11}, {OverWorld12}, {OverWorld13}, {OverWorld14}, {Door1}, {Dungeon1}, {Dungeon2},
};

uint8_t currentMap = 0;

void drawMap (uint8_t Index){
	currentMap = Index;
	uint8_t xpos, ypos, xIndex = 0;
	for(xpos = 8; xpos < 128 + 8; xpos += 16){
		uint8_t yIndex = 0;
		for(ypos = 15; ypos < 160 + 16; ypos += 16){
			ST7735_DrawBitmap(xpos, ypos, getTile(Maps[currentMap].ScreenMap[0][yIndex][xIndex]), 16, 16);
 			yIndex++;
		}
		xIndex++;
	}
	setGrid (Maps[currentMap].ScreenMap[0]);
}

void drawTile (int8_t xIndex, int8_t yIndex){
	if(xIndex != -1 && xIndex != 8 && yIndex != -1 && yIndex != 10)
	ST7735_DrawBitmap((xIndex * 16) + 8, (yIndex * 16) + 15, getTile(Maps[currentMap].ScreenMap[0][yIndex][xIndex]), 16, 16);
}
void reDrawTile (uint8_t xIndex, uint8_t yIndex, int16_t drawX, int16_t drawY, uint8_t width, uint8_t height, uint8_t direction){
	if(Maps[currentMap].ScreenMap[0][yIndex][xIndex] != 8){
		SpriteDraw(drawX + width, drawY, getTile(4), 1, height);
		SpriteDraw(drawX, drawY + 1, getTile(4), width, 1);
		if(drawX - 1 < 8) SpriteDraw(drawX, drawY, getTile(4), 1, height);
		else SpriteDraw(drawX - 1, drawY, getTile(4), 1, height);
		SpriteDraw(drawX, drawY - height, getTile(4), width, 1);
	}
	else
		drawTile(xIndex, yIndex);
}
const unsigned short * getMapTile(uint8_t xIndex, uint8_t yIndex){
	return getTile(Maps[currentMap].ScreenMap[0][yIndex][xIndex]);
}

